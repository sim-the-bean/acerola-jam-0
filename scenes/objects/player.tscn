[gd_scene load_steps=16 format=3 uid="uid://dju6tadl6ss46"]

[ext_resource type="Script" path="res://scripts/player.gd" id="1_6168c"]
[ext_resource type="Script" path="res://addons/phantom_camera/scripts/phantom_camera/phantom_camera_3D.gd" id="1_ca6ab"]
[ext_resource type="Script" path="res://scripts/debug_mesh.gd" id="3_43qcu"]
[ext_resource type="Script" path="res://addons/phantom_camera/scripts/resources/tween_resource.gd" id="3_77h2n"]
[ext_resource type="Shader" path="res://shaders/hud.gdshader" id="4_8egmf"]
[ext_resource type="PackedScene" uid="uid://ntyjgfrwrkcf" path="res://scenes/components/effect_component.tscn" id="4_ftkig"]
[ext_resource type="PackedScene" uid="uid://cf8tm3pqh5qqf" path="res://scenes/components/kill_component.tscn" id="6_7g65a"]
[ext_resource type="PackedScene" uid="uid://8ib6xi3owdyw" path="res://scenes/ui/hud.tscn" id="7_mnk68"]
[ext_resource type="Script" path="res://scripts/follow_main_viewport.gd" id="8_i8mnh"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_peuui"]
radius = 0.3
height = 1.7

[sub_resource type="Resource" id="Resource_mhn63"]
script = ExtResource("3_77h2n")
duration = 1.0
transition = 1
ease = 2

[sub_resource type="ViewportTexture" id="ViewportTexture_ctx18"]
viewport_path = NodePath("HudViewport")

[sub_resource type="ShaderMaterial" id="ShaderMaterial_4x8y4"]
resource_local_to_scene = true
render_priority = 0
shader = ExtResource("4_8egmf")
shader_parameter/hud_viewport = SubResource("ViewportTexture_ctx18")

[sub_resource type="QuadMesh" id="QuadMesh_focja"]
resource_local_to_scene = true
material = SubResource("ShaderMaterial_4x8y4")
flip_faces = true
size = Vector2(2, 2)

[sub_resource type="SphereMesh" id="SphereMesh_hqq2u"]
radius = 0.01
height = 0.02

[node name="Player" type="CharacterBody3D"]
collision_layer = 73
script = ExtResource("1_6168c")
air_control = 1.0

[node name="Collider" type="CollisionShape3D" parent="."]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.85, 0)
shape = SubResource("CapsuleShape3D_peuui")

[node name="CameraPivot" type="Node3D" parent="."]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.5, 0)

[node name="PlayerCamera" type="Node3D" parent="CameraPivot"]
unique_name_in_owner = true
script = ExtResource("1_ca6ab")
priority_override = false
priority = 20
follow_mode = 0
look_at_mode = 0
tween_parameters = SubResource("Resource_mhn63")
tween_on_load = false
inactive_update_mode = 0
camera_3D_resource = null

[node name="HudQuad" type="MeshInstance3D" parent="CameraPivot/PlayerCamera"]
unique_name_in_owner = true
visible = false
mesh = SubResource("QuadMesh_focja")

[node name="RayCast" type="RayCast3D" parent="CameraPivot"]
unique_name_in_owner = true
target_position = Vector3(0, 0, -2.5)
collision_mask = 20

[node name="GrabPoint" type="Node3D" parent="CameraPivot/RayCast"]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -2.5)

[node name="MeshInstance3D" type="MeshInstance3D" parent="CameraPivot/RayCast/GrabPoint"]
cast_shadow = 0
mesh = SubResource("SphereMesh_hqq2u")
script = ExtResource("3_43qcu")

[node name="HoldItemPoint" type="Node3D" parent="CameraPivot"]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 0.936678, 0.350191, 0, -0.350191, 0.936678, 0, -0.186727, -0.728917)

[node name="HoldMenuPoint" type="Node3D" parent="."]
unique_name_in_owner = true
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1.31327, -0.728917)

[node name="EffectComponent" parent="." instance=ExtResource("4_ftkig")]
unique_name_in_owner = true

[node name="KillComponent" parent="." instance=ExtResource("6_7g65a")]
unique_name_in_owner = true
killed_interval = 3.0
free_on_killed = false
unkillable_duration = 3.0

[node name="HudViewport" type="SubViewport" parent="."]
unique_name_in_owner = true
disable_3d = true
transparent_bg = true
size = Vector2i(1348, 536)
script = ExtResource("8_i8mnh")

[node name="Hud" parent="HudViewport" instance=ExtResource("7_mnk68")]
unique_name_in_owner = true

[connection signal="killed" from="KillComponent" to="." method="on_killed"]
[connection signal="killing" from="KillComponent" to="." method="on_killing"]
